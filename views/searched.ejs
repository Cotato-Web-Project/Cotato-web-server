<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>게시글</title>
  </head>

  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"
  ></script>

  <body>
    <h1 onclick="location.href='/'">게시글 목록</h1>
    <hr />
    <div>
        <% item.forEach(function(data) { %>
  
        <div style="display: inline-block">
          <p>
            <% if(data.img) { %>
            <img
              src="data:data/<%=data.img.contentType%>;base64,
                           <%=data.img.data.toString('base64')%>"
              width="200px"
              height="200px"
            />
            <% }%>
            <div onclick="location.href='/<%=data.id%>'">
              <h5>제목 : <%= data.title %></h5>
              <p>내용 : <%= data.desc %></p>
            </div>
          </p>
          <button onclick="location.href='/updatePost/<%=data.id%>'">수정</button>
          <button class="delete" data-id="<%=data.id%>">삭제</button>
        </div>
        <% }) %>
      </div>
      <div>
        <br>
      <form action="/search" method="GET" enctype="multipart/form-data">
        <label for="search"></label>
        <select name = 'option'>
          <option selected value="title">제목</option>
          <option value="content">내용</option>
          <option value="title+content">제목 + 내용</option>
        </select>
        <input
          type="text"
          id="content"
          placeholder="검색"
          value=""
          name="content"
          required
        />
        <button type="submit">검색</button>
      </form>
    </div>
  </body>

  <script>
    $(".delete").click(function(e) {
      $.ajax({
        method: "DELETE",
        url: "/deletePost",
        data: { id: e.target.dataset.id },
      })
        .always((result) => {
          console.log(e)
          $(this).parent("div").fadeOut()
        })
        
    })
  </script>
</html>